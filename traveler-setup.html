<!DOCTYPE html>
<html class="light" lang="en">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>Traveler Registration</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700&display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap" rel="stylesheet"/>
    <script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#2b8cee",
                        "background-light": "#f6f7f8",
                        "background-dark": "#101922",
                    },
                    fontFamily: {
                        "display": ["Plus Jakarta Sans"]
                    },
                    borderRadius: { "DEFAULT": "0.25rem", "lg": "0.5rem", "xl": "0.75rem", "full": "9999px" },
                },
            },
        }
    </script>
    <style type="text/tailwindcss">
        body { font-family: "Plus Jakarta Sans", sans-serif; min-height: 100dvh; }
        .form-input:focus { border-color: #2b8cee !important; @apply ring-0; }
    </style>
</head>
<body class="bg-background-light dark:bg-background-dark font-display text-[#0d141b] dark:text-slate-100 min-h-screen flex flex-col">

<header class="sticky top-0 z-50 bg-background-light dark:bg-background-dark border-b border-slate-200 dark:border-slate-800">
    <div class="flex items-center p-4 justify-center">
        <h2 class="text-[#0d141b] dark:text-white text-lg font-bold">CJ Travel</h2>
    </div>
</header>

<main class="flex-1 overflow-y-auto pb-24">
    <div class="px-4 pt-6 pb-2">
        <h1 class="text-[#0d141b] dark:text-white text-[32px] font-bold">Traveler Registration</h1>
        <p class="text-[#4c739a] dark:text-slate-400 text-base mt-2">Join our global community of explorers.</p>
    </div>

    <form class="space-y-1" id="regForm">
        <div class="px-4 py-3">
            <label class="flex flex-col">
                <p class="text-base font-medium pb-2">Full Name</p>
                <input id="fullName" class="form-input rounded-lg border-[#cfdbe7] dark:border-slate-700 bg-background-light dark:bg-slate-900 h-14 p-[15px]" placeholder="Enter your full name" type="text"/>
            </label>
        </div>

        <div class="px-4 py-3">
            <label class="flex flex-col">
                <p class="text-base font-medium pb-2">Email Address</p>
                <input id="regEmail" class="form-input rounded-lg border-[#cfdbe7] dark:border-slate-700 bg-background-light dark:bg-slate-900 h-14 p-[15px]" placeholder="example@mail.com" type="email"/>
            </label>
        </div>

        <div class="px-4 py-3">
            <label class="flex flex-col">
                <p class="text-base font-medium pb-2">Password</p>
                <input id="regPassword" class="form-input rounded-lg border-[#cfdbe7] dark:border-slate-700 bg-background-light dark:bg-slate-900 h-14 p-[15px]" placeholder="••••••••" type="password"/>
            </label>
        </div>

        <div class="px-4 py-3">
            <label class="flex flex-col">
                <p class="text-base font-medium pb-2">Date of Birth</p>
                <input id="dob" class="form-input rounded-lg border-[#cfdbe7] dark:border-slate-700 bg-background-light dark:bg-slate-900 h-14 p-[15px]" type="date"/>
            </label>
        </div>

        <div class="px-4 py-3">
            <label class="flex flex-col">
                <p class="text-base font-medium pb-2">Nationality</p>
                <select id="countrySelect" class="form-input rounded-lg border-[#cfdbe7] dark:border-slate-700 bg-background-light dark:bg-slate-900 h-14 p-[15px]">
                    <option disabled selected value="">Select nationality</option>
                </select>
            </label>
        </div>

        <div class="px-4 py-3">
            <label class="flex flex-col">
                <p class="text-base font-medium pb-2">Phone Number</p>
                <input id="phone" class="form-input rounded-lg border-[#cfdbe7] dark:border-slate-700 bg-background-light dark:bg-slate-900 h-14 p-[15px]" placeholder="+976 0000-0000" type="tel"/>
            </label>
        </div>
    </form>
</main>
<footer class="fixed bottom-0 left-0 right-0 p-4 bg-background-light dark:bg-background-dark border-t border-slate-200 dark:border-slate-800">
    <div class="flex gap-4 max-w-[480px] mx-auto">
        <button id="backBtn" class="flex-1 h-14 rounded-xl border border-[#cfdbe7] dark:border-slate-700 font-bold bg-white dark:bg-slate-800">Back</button>
        <button id="createBtn" class="flex-1 h-14 rounded-xl bg-primary text-white font-bold shadow-sm">Create Account</button>
    </div>
</footer>

<script>
    // 1. Initialize Countries List
    // Note: Keep your full list of countries here
    const countries = ["Afghanistan", "Albania", "...", "Mongolia", "..."]; 
    
    const select = document.getElementById('countrySelect');
    
    // Dynamically populate the nationality dropdown
    countries.forEach(country => {
        let opt = document.createElement('option');
        opt.value = country;
        opt.innerHTML = country;
        select.appendChild(opt);
    });

    // 2. Registration and Storage Logic
    const createBtn = document.getElementById('createBtn');
    if (createBtn) {
        createBtn.addEventListener('click', (e) => {
            // Prevent default form submission behavior
            e.preventDefault();

            // Collect user data from input fields
            const userData = {
                name: document.getElementById('fullName').value,
                email: document.getElementById('regEmail').value,
                password: document.getElementById('regPassword').value,
                dob: document.getElementById('dob').value,
                nationality: document.getElementById('countrySelect').value,
                phone: document.getElementById('phone').value,
                role: 'traveler', // Set default role as traveler
                joinedAt: new Date().toLocaleDateString() // Record registration date
            };

            // Validation: Check if required fields are filled
            if(!userData.email || !userData.password || !userData.name) {
                alert("Please fill in your Name, Email, and Password!");
                return;
            }

            // LocalStorage Management: Retrieve existing users or initialize empty array
            let users = JSON.parse(localStorage.getItem('users')) || [];
            
            // Duplicate Check: Ensure the email is not already registered
            if(users.some(u => u.email === userData.email)) {
                alert("This email address is already registered!");
                return;
            }

            // Save data: Add new user to the array and update LocalStorage
            users.push(userData);
            localStorage.setItem('users', JSON.stringify(users));

            // Success feedback and navigation
            alert("Account successfully created!");
            window.location.href = "interests.html"; 
        });
    }

    // 3. Navigation: Back button functionality
    const backBtn = document.getElementById('backBtn');
    if (backBtn) {
        backBtn.addEventListener('click', () => {
            window.location.href = "role-selection.html";
        });
    }
</script>

</body>
</html>
