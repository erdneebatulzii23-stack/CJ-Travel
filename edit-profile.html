<!DOCTYPE html>
<html lang="mn">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>Edit Profile</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700&display=swap" rel="stylesheet"/>
    <style>
        body { font-family: 'Plus Jakarta Sans', sans-serif; }
        /* Icon-ийг текст шиг харагдуулахгүй байх тохиргоо */
        .material-symbols-outlined {
            font-family: 'Material Symbols Outlined';
            font-weight: normal;
            font-style: normal;
            font-size: 24px;
            display: inline-block;
            line-height: 1;
            text-transform: none;
            letter-spacing: normal;
            word-wrap: normal;
            white-space: nowrap;
            direction: ltr;
        }
    </style>
</head>
<body class="bg-[#f8fafc] text-[#1e293b]">

    <div class="max-w-[480px] mx-auto min-h-screen bg-white shadow-sm flex flex-col">
        
        <header class="flex items-center px-4 py-4 border-b border-gray-100 sticky top-0 bg-white z-10">
            <button onclick="window.history.back()" class="w-10 h-10 flex items-center justify-center rounded-full hover:bg-gray-100 transition-colors">
                <span class="material-symbols-outlined">arrow_back</span>
            </button>
            <h1 class="flex-1 text-center text-lg font-bold mr-10">Профайл засах</h1>
        </header>

        <main class="flex-1 px-6">
            <div class="flex flex-col items-center py-8">
                <div class="relative">
                    <div id="imagePreview" 
                         class="w-32 h-32 rounded-full border-4 border-white shadow-md bg-cover bg-center bg-gray-100"
                         style="background-image: url('https://cdn.pixabay.com/photo/2015/10/05/22/37/blank-profile-picture-973460_1280.png');">
                    </div>
                    <label for="fileInput" class="absolute bottom-0 right-0 bg-[#2b8cee] text-white w-10 h-10 rounded-full flex items-center justify-center border-2 border-white shadow-lg cursor-pointer hover:scale-110 transition-transform">
                        <span class="material-symbols-outlined text-[20px]">photo_camera</span>
                        <input type="file" id="fileInput" class="hidden" accept="image/*" onchange="previewImage(event)">
                    </label>
                </div>
                <button onclick="document.getElementById('fileInput').click()" class="mt-4 text-[#2b8cee] text-sm font-semibold hover:underline">Зураг солих</button>
            </div>

            <div class="space-y-6">
                <div class="space-y-2">
                    <label class="text-[13px] font-bold text-gray-400 uppercase tracking-wider ml-1">Бүтэн нэр</label>
                    <input id="edit-name" type="text" class="w-full px-4 py-4 rounded-2xl bg-gray-50 border border-gray-100 focus:border-[#2b8cee] focus:bg-white focus:ring-4 focus:ring-[#2b8cee]/10 outline-none transition-all" placeholder="Нэрээ оруулна уу">
                </div>

                <div class="space-y-2">
                    <label class="text-[13px] font-bold text-gray-400 uppercase tracking-wider ml-1">И-мэйл (Өөрчлөх боломжгүй)</label>
                    <input id="edit-email" type="email" readonly class="w-full px-4 py-4 rounded-2xl bg-gray-100 border border-gray-100 text-gray-500 cursor-not-allowed outline-none" placeholder="example@mail.com">
                </div>

                <div class="space-y-2">
                    <label class="text-[13px] font-bold text-gray-400 uppercase tracking-wider ml-1">Утасны дугаар</label>
                    <input id="edit-phone" type="tel" class="w-full px-4 py-4 rounded-2xl bg-gray-50 border border-gray-100 focus:border-[#2b8cee] focus:bg-white focus:ring-4 focus:ring-[#2b8cee]/10 outline-none transition-all" placeholder="99112233">
                </div>
            </div>
        </main>

        <div class="p-6 mt-auto">
            <button onclick="saveProfileChanges()" class="w-full bg-[#2b8cee] text-white py-4 rounded-2xl font-bold text-lg shadow-lg shadow-[#2b8cee]/20 hover:bg-[#2370c0] active:scale-[0.98] transition-all">
                Өөрчлөлтийг хадгалах
            </button>
        </div>
    </div>

    <script>
        // Профайл зураг урьдчилан харах
        function previewImage(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('imagePreview').style.backgroundImage = `url('${e.target.result}')`;
                    localStorage.setItem('tempProfilePic', e.target.result);
                };
                reader.readAsDataURL(file);
            }
        }

        // Мэдээлэл хадгалах функц
        function saveProfileChanges() {
            const name = document.getElementById('edit-name').value;
            const phone = document.getElementById('edit-phone').value;
            const newPic = localStorage.getItem('tempProfilePic');

            if(!name) { alert("Нэрээ оруулна уу"); return; }

            let currentUser = JSON.parse(localStorage.getItem('currentUser')) || {};
            currentUser.name = name;
            currentUser.phone = phone;
            if(newPic) currentUser.profilePic = newPic;

            localStorage.setItem('currentUser', JSON.stringify(currentUser));
            localStorage.removeItem('tempProfilePic');
            
            alert("Амжилттай хадгалагдлаа!");
            window.location.href = 'profile.html';
        }

        // Хуудас нээгдэхэд мэдээллийг татаж бөглөх
        window.onload = function() {
            const user = JSON.parse(localStorage.getItem('currentUser'));
            if(user) {
                document.getElementById('edit-name').value = user.name || '';
                document.getElementById('edit-email').value = user.email || '';
                document.getElementById('edit-phone').value = user.phone || '';
                if(user.profilePic) {
                    document.getElementById('imagePreview').style.backgroundImage = `url('${user.profilePic}')`;
                }
            }
        }
    </script>
</body>
</html>
